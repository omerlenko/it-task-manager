{% extends "base.html" %}

{% block content %}

  <div class="container mt-4">
    <div class="row g-4">
{#      <h1 class="ml-auto">Welcome back, {{ user.first_name }}</h1>#}
      <h1 class="text-center">Dashboard</h1>
      <!-- Task Overview Card -->
      <div class="col-md-6">
        <div class="card shadow-sm h-100">
          <div class="card-header text-center fs-3">Task Overview</div>
          <div class="card-body d-flex flex-column justify-content-center p-4">
            <div class="d-flex align-items-center mb-2">
              <div class="circle clr-primary me-3"></div>
              <div class="fs-4 me-auto">Total Tasks</div>
              <div class="fs-2 fw-bold">{{ total_tasks }}</div>
            </div>
            <div class="d-flex align-items-center mb-2">
              <div class="circle clr-warning me-3"></div>
              <div class="fs-4 me-auto">Pending</div>
              <div class="fs-2 fw-bold">{{ pending_tasks }}</div>
            </div>
            <div class="d-flex align-items-center">
              <div class="circle clr-success me-3"></div>
              <div class="fs-4 me-auto">Completed</div>
              <div class="fs-2 fw-bold">{{ completed_tasks }}</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Upcoming Deadlines Card -->
      <div class="col-md-6">
        <div class="card shadow-sm h-100">
          <div class="card-header text-center fs-3">Upcoming Deadlines</div>
          <div class="card-body p-3">
            <ul class="list-group">
              {% for task in upcoming_deadlines %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  <a href="{% url 'task_manager:task-detail' pk=task.id %}" class="text-decoration-none text-dark fs-5">
                    {{ task.name }}
                  </a>
                  <span class="badge bg-danger">{{ task.deadline|date:"M d" }}</span>
                </li>
              {% empty %}
                <li class="list-group-item text-muted text-center">No upcoming tasks</li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>

      <!-- Task Count by Priority -->
      <div class="col-md-6">
        <div class="card shadow-sm h-100">
          <div class="card-header text-center fs-3">Tasks by Priority</div>
          <div class="card-body d-flex flex-column justify-content-center p-4">
            {% for priority, count in task_priority_counts.items %}
              <div class="d-flex  align-items-center mb-2">

                <div class="circle me-3
                 {% if priority == "Urgent" %} clr-danger
                 {% elif priority == "High" %} clr-warning
                 {% elif priority == "Medium" %} clr-primary
                 {% else %} clr-default
                 {% endif %}"></div>

                <span class="fs-4 me-auto">{{ priority }}</span>
                <span class="fs-2 fw-bold">{{ count }}</span>
              </div>
            {% empty %}
              <p class="fs-5 text-muted text-center">No priority tasks</p>
            {% endfor %}
          </div>
        </div>
      </div>

      <!-- Weekly Progress -->
      <div class="col-md-6">
        <div class="card shadow-sm h-100">
          <div class="card-header text-center fs-3">This Week's Progress</div>
          <div class="card-body d-flex flex-column justify-content-center text-center p-4">
            <div class="fs-4 mb-3"><strong>{{ weekly_completed_tasks }} / {{ weekly_total_tasks }}</strong> completed</div>
            <div class="progress mx-auto mb-3" style="height: 16px; width: 80%;">
              <div class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                   role="progressbar"
                   style="width: {{ weekly_completion_percentage }}%;"
                   aria-valuenow="{{ weekly_completion_percentage }}"
                   aria-valuemin="0" aria-valuemax="100">
              </div>
            </div>
            <small class="text-muted fs-5">{{ weekly_completion_percentage }}% of this week's tasks done</small>
          </div>
        </div>
      </div>
      <div class="mt-4">
        <a href="{% url "task_manager:task-create" %}" class="btn btn-primary">Add New Task</a>
      </div>
    </div>
  </div>


{% endblock %}


{#  <div class="container mt-4">#}
{#    <h1>Dashboard</h1>#}
{#    <div class="row">#}
{#        <!-- Task Overview Card -->#}
{#        <div class="col-md-4">#}
{#            <div class="card">#}
{#                <div class="card-body">#}
{#                    <h5 class="card-title">Task Overview</h5>#}
{#                    <p>Total Tasks: {{ total_tasks }}</p>#}
{#                    <p>Pending: {{ pending_tasks }}</p>#}
{#                    <p>Completed: {{ completed_tasks }}</p>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{##}
{#        <!-- Priority Breakdown Card -->#}
{#        <div class="col-md-4">#}
{#            <div class="card">#}
{#                <div class="card-body">#}
{#                    <h5 class="card-title">Priority Breakdown</h5>#}
{#                    <ul>#}
{#                        <li>Urgent: {{ urgent_tasks }}</li>#}
{#                        <li>High: {{ high_tasks }}</li>#}
{#                        <li>Medium: {{ medium_tasks }}</li>#}
{#                        <li>Low: {{ low_tasks }}</li>#}
{#                    </ul>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{##}
{##}
{#    </div>#}
{##}
{#    <div class="row mt-4">#}
{#      <!-- Upcoming Deadlines Card -->#}
{#        <div class="col-md-4">#}
{#            <div class="card">#}
{#                <div class="card-body">#}
{#                    <h5 class="card-title">Upcoming Deadlines</h5>#}
{#                    <ul>#}
{#                        {% for task in upcoming_deadlines %}#}
{#                            <li>{{ task.name }} - {{ task.deadline }}</li>#}
{#                        {% endfor %}#}
{#                    </ul>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{##}
{#      <!-- Upcoming Deadlines Card -->#}
{#        <div class="col-md-4">#}
{#            <div class="card">#}
{#                <div class="card-body">#}
{#                    <h5 class="card-title">Upcoming Deadlines</h5>#}
{#                    <ul>#}
{#                        {% for task in upcoming_deadlines %}#}
{#                            <li>{{ task.name }} - {{ task.deadline }}</li>#}
{#                        {% endfor %}#}
{#                    </ul>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#    </div>#}
{##}
{#    <!-- Quick Add Task Button -->#}
{#    <div class="mt-4">#}
{#        <a href="{% url "task_manager:task-create" %}" class="btn btn-primary">Add Task</a>#}
{#    </div>#}
{#  </div>#}




{#  {% if user.is_authenticated %}#}
{#    <h1>Welcome back, {{ user.first_name }}</h1>#}
{##}
{#    <div>#}
{#      <div>Total tasks: {{ all_tasks.count }}</div>#}
{#      <div>Pending tasks: {{ pending_tasks.count }}</div>#}
{#      <div>Completed tasks: {{ completed_tasks.count }}</div>#}
{#    </div>#}
{##}
{#    <div>#}
{#      <div>Urgent tasks: {{ pending_tasks.priority.filter }}</div>#}
{#    </div>#}

{#  {% if pending_tasks %}#}
{#  <p>#}
{#    You have {{ pending_tasks.count }} pending task{{ s|pluralize }}:#}
{#  </p>#}
{#  <ul>#}
{#  {% for task in pending_tasks %}#}
{#    <li>#}
{#      {{ task.name }}#}
{#    </li>#}
{#  {% endfor %}#}
{#  </ul>#}
{#  {% else %}#}
{#  <p>#}
{#    There are no pending tasks#}
{#  </p>#}
{#  {% endif %}#}
{##}
{##}
{#  {% if completed_tasks %}#}
{#  <p>#}
{#    You have {{ completed_tasks.count }} completed task{{ s|pluralize }}:#}
{#  </p>#}
{#  <ul>#}
{#  {% for task in completed_tasks %}#}
{#    <li>#}
{#      {{ task.name }}#}
{#    </li>#}
{#  {% endfor %}#}
{#  </ul>#}
{#  {% else %}#}
{#  <p>#}
{#    There are no completed tasks#}
{#  </p>#}
{#  {% endif %}#}
{##}
{#  <a href="#">Add task</a>#}
{#  <a href="#">View all tasks</a>#}
{##}
{#  {% else %}#}
{#    <h1>Welcome to the Task Manager, log in to start adding tasks!</h1>#}
{#  {% endif %}#}



